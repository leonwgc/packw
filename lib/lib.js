"use strict";var __importDefault=function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getSsrLib=void 0;var pack_1=require("./pack"),chalk_1=__importDefault(require("chalk")),path_1=__importDefault(require("path")),webpack_1=__importDefault(require("webpack")),webpack_node_externals_1=__importDefault(require("webpack-node-externals")),webpack_merge_1=__importDefault(require("webpack-merge")),getProjectPath=function(a){return void 0===a&&(a="./"),path_1.default.join(process.cwd(),a)},getSsrLib=function(a,b,c){void 0===b&&(b="./ssr-lib");var d=(0,pack_1.getWebpackConfig)(!1,a,"","node"),e={entry:a,externals:[(0,webpack_node_externals_1.default)()],output:{path:getProjectPath(b),filename:"[name].js",library:{type:"commonjs2"}}},f=(0,webpack_merge_1.default)({},d,e),g=(0,webpack_1.default)(f);g.run(function(a,b){(a||b.hasErrors())&&console.log(a.stack||a.message||a),g.close(function(){console.log(chalk_1.default.green("successfully finished!")),null===c||void 0===c?void 0:c()})})};exports.getSsrLib=getSsrLib;
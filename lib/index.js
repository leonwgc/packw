var K=Object.create;var S=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var U=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var G=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports);var J=(e,o,n,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let s of F(o))!N.call(e,s)&&s!==n&&S(e,s,{get:()=>o[s],enumerable:!(r=M(o,s))||r.enumerable});return e};var t=(e,o,n)=>(n=e!=null?K(U(e)):{},J(o||!e||!e.__esModule?S(n,"default",{value:e,enumerable:!0}):n,e));var z=G((je,ce)=>{ce.exports={name:"packw",version:"2.4.0",description:"Webpack5 out-of-the-box dx for react project.",bin:{packw:"./bin/cli.js"},main:"./lib/pack.js",typings:"./types/pack.d.ts",scripts:{dev:"father-build -w",build:"father-build && tsc","build-new":"tsup && tsc"},tags:["react","webpack","webpack5","webpack-cli tool"],keywords:["react","webpack","webpack-cli tool"],author:"leonwgc",license:"MIT",dependencies:{"@babel/cli":"^7.25.9","@babel/core":"^7.26.0","@babel/eslint-parser":"^7.25.9","@babel/plugin-proposal-class-properties":"^7.0.0","@babel/plugin-proposal-decorators":"^7.17.2","@babel/plugin-syntax-dynamic-import":"^7.0.0","@babel/plugin-syntax-import-meta":"^7.0.0","@babel/plugin-transform-nullish-coalescing-operator":"^7.18.6","@babel/plugin-transform-optional-chaining":"^7.16.7","@babel/plugin-transform-runtime":"^7.25.9","@babel/preset-env":"^7.26.0","@babel/preset-react":"^7.25.9","@babel/preset-typescript":"^7.26.0","@babel/runtime":"^7.26.0","@babel/runtime-corejs3":"^7.26.0","@pmmmwh/react-refresh-webpack-plugin":"^0.5.15",address:"^2.0.3","ali-oss":"^6.22.0",autoprefixer:"^10.4.20","babel-loader":"^9.2.1","babel-plugin-import":"^1.13.8","babel-plugin-lodash":"^3.3.4",chalk:"^4.1.2",cheerio:"^1.0.0-rc.12","clean-webpack-plugin":"^4.0.0",commander:"^8.3.0","core-js":"^3.39.0","css-loader":"^7.1.2","css-minimizer-webpack-plugin":"^7.0.0",draftlog:"^1.0.13",ejs:"^3.1.10","fs-extra":"^11.2.0",glob:"^11.0.0","html-webpack-plugin":"^5.6.3","import-local":"^3.2.0",less:"^3.13.1","less-loader":"^10.2.0","mini-css-extract-plugin":"^2.9.2",postcss:"^8.4.49","postcss-flexbugs-fixes":"^5.0.2","postcss-loader":"^8.1.1","postcss-preset-env":"^10.1.1","react-refresh":"^0.14.2",sass:"^1.82.0","sass-loader":"^12.6.0","style-loader":"^4.0.0",typescript:"^5.7.2",webpack:"^5.97.0","webpack-dev-server":"^3.11.3","webpack-merge":"^5.10.0","webpack-node-externals":"^3.0.0",webpackbar:"^7.0.0",yargs:"^17.7.2"},devDependencies:{"@types/glob":"^7.2.0","@types/node":"^16.18.96","@types/webpack-dev-server":"^3.11.6","babel-preset-minify":"^0.5.2","father-build":"^1.22.5",tsup:"^8.3.5"},files:["lib","bin","types"]}});var H=require("commander");var q=t(require("path")),h=t(require("fs")),b=t(require("process")),f=t(require("chalk")),k=t(require("glob")),w=t(require("mini-css-extract-plugin")),R=t(require("css-minimizer-webpack-plugin")),O=t(require("@pmmmwh/react-refresh-webpack-plugin")),E=t(require("webpackbar")),D=require("clean-webpack-plugin"),W=t(require("webpack-dev-server")),y=t(require("webpack")),oe=t(require("webpack-merge")),T=t(require("html-webpack-plugin")),A=require("address");var C=`
<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,minimal-ui,viewport-fit=cover"
    />
    <meta name="format-detection" content="telephone=no, email=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-touch-fullscreen" content="yes" />
    <title></title>
  </head>
  <body>
    <div id="root"></div>
  </body>
</html>`;var B=t(require("chalk"));var X=t(require("webpack"));var Y=t(require("webpack-node-externals")),Q=t(require("cheerio")),V=t(require("webpack-merge"));var Z=t(require("ali-oss"));var ee=t(require("fs-extra")),te=t(require("chalk"));var $=t(require("draftlog"));$.default.into(console);var se=9e3,m=(e="./")=>q.default.join(b.default.cwd(),e);function L(e){console.log(f.default.red(e)),b.default.exit(9)}var x=(e="less",o,n)=>{let r=[{loader:require.resolve("css-loader"),options:{sourceMap:o}},{loader:require.resolve("postcss-loader"),options:{postcssOptions:{plugins:[require("postcss-preset-env")({autoprefixer:{flexbox:"no-2009"},stage:3})],sourceMap:o}}}];switch(e){case"less":{r.push({loader:require.resolve("less-loader"),options:{lessOptions:{relativeUrls:!1,javascriptEnabled:!0},sourceMap:o}});break}case"sass":{r.push({loader:require.resolve("sass-loader"),options:{sourceMap:o}});break}case"custom":{if(typeof n=="function"){let s=n();s&&(r=r.concat(s))}break}}return o?r.unshift({loader:require.resolve("style-loader")}):r.unshift({loader:w.default.loader}),r},re=e=>{let o=[[require.resolve("@babel/plugin-transform-runtime")],[require.resolve("@babel/plugin-proposal-decorators"),{legacy:!0}],[require.resolve("@babel/plugin-proposal-class-properties"),{loose:!1}]];return e&&o.push([require.resolve("react-refresh/babel")]),{cacheDirectory:!0,presets:[[require.resolve("@babel/preset-env"),{modules:"auto"}],[require.resolve("@babel/preset-react"),{runtime:"automatic"}],require.resolve("@babel/preset-typescript")],plugins:o}},P=e=>({type:"asset",parser:{dataUrlCondition:{maxSize:8*1024}},generator:{filename:`${e}/[name].[hash:8][ext]`}}),ne=(e=[],o)=>{let n=h.default.existsSync(m("./index.tpl.js"));!n&&!h.default.existsSync(m("./index.html"))&&h.default.writeFileSync(m("./index.html"),C);let r=[];for(let s of e)r.push(new T.default(Object.assign({filename:`${s}.html`,[n&&!o?"templateContent":"template"]:n&&!o?({htmlWebpackPlugin:c})=>require(m("./index.tpl.js"))(c):m("index.html"),chunks:[s,"vendor","common","runtime"]},o?void 0:{minify:{removeComments:!0,collapseWhitespace:!0,removeRedundantAttributes:!0,useShortDoctype:!0,removeEmptyAttributes:!0,removeStyleLinkTypeAttributes:!0,keepClosingSlash:!0,minifyJS:!0,minifyCSS:!0,minifyURLs:!0}})));return r},j=(e=!0,o={},n="/",r="web",s)=>{let c=Object.keys(o),i=r==="node",a=i?[]:ne(c,e),l=c.join("-"),g=i?[{test:/\.(less|sass|scss|css)$/,use:require.resolve("./ignore")}]:[{test:/\.less$/,use:x("less",e)},{test:/\.s[ac]ss$/i,use:x("sass",e)},{test:/\.css$/,use:x("css",e)}],p=[new D.CleanWebpackPlugin,new y.default.DefinePlugin({__dev__:e})];typeof s=="string"&&s.trim()&&p.push(new E.default({name:s})),i||(p.push(new w.default({filename:"[name].[contenthash:6].css",chunkFilename:"[name].[contenthash:6].css"})),p.push(...a));let u={mode:e?"development":"production",bail:!e,entry:o,output:{path:m("./dist"),chunkFilename:"[name].[contenthash:6].js",filename:e?"[name].js":"[name].[contenthash:6].js",publicPath:n},devtool:e?"cheap-module-source-map":!1,target:r,cache:i?!1:e?{type:"filesystem",name:l,buildDependencies:{config:[__filename]},store:"pack"}:{type:"filesystem",name:l+"-prd",buildDependencies:{config:[__filename]},store:"pack"},module:{rules:[{test:/\.[j|t]sx?$/,exclude:/node_modules/,use:{loader:require.resolve("babel-loader"),options:re(e)}},{test:/\.(png|jpg|gif|jpeg|svg)$/,...P("images")},{test:/\.(ttf|otf|woff|woff2|eot)$/,...P("fonts")},...g]},resolve:{extensions:[".js",".jsx",".ts",".tsx"],alias:{"~":m("./src"),"@":m("./src")}},optimization:{splitChunks:{name:!1,cacheGroups:{common:{name:"common",chunks:"all",minChunks:2},vendor:{name:"vendor",test:/[\\/]node_modules[\\/]/,chunks:"all",priority:10}}},runtimeChunk:i?!1:{name:"runtime"},moduleIds:e?"named":"deterministic",chunkIds:e?"named":"deterministic"},stats:"errors-warnings",plugins:p};return e?u.plugins.push(new O.default({overlay:!1})):u.optimization={...u.optimization,minimize:!0,minimizer:[new R.default,"..."]},u},ie=(e,o="index",n,r,s,c)=>{if(n){let i=(0,y.default)(e),a={compress:!0,host:"0.0.0.0",disableHostCheck:!0,hot:!0,inline:!0,noInfo:!0,sockPort:"location",...s},l=a.port||r,g=new W.default(i,a);g.listen(l,a.host,p=>{p&&L(p);let u=`${o==="index"?"":o+".html"}`,I=`http://localhost:${l}/${u}`,_=`http://${(0,A.ip)()}:${l}/${u}`;console.log(f.default.cyan("dev server is listening at")),console.log(),console.log("> Local:",f.default.green(`${I}`)),console.log(),console.log("> Network:",f.default.green(`${_}`))}),["SIGINT","SIGTERM"].forEach(p=>{b.default.on(p,()=>{g&&g.close(),b.default.exit()})})}else{let i=(0,y.default)(e);i.run((a,l)=>{(a||l.hasErrors())&&console.log(l),i.close(()=>{console.log(f.default.green("done \u{1F37A} ")),c?.()})})}},v=(e="index",o="/",n=!0,r=se)=>{let s=k.default.sync(`./src/${e}/index{.jsx,.js,.ts,.tsx}`),c=!0;s.length||(s=k.default.sync("./src/index{.jsx,.js,.ts,.tsx}"),s.length||L(`Entry not found : ${m("./src/index")}`),c=!1);let i=s[0],a=j(n,{[e]:i},o);ie(a,c?e:"index",n,r)};var d=new H.Command("packw");d.name("packw").usage("[options] start/build/run");d.version(z().version,"-v, --version");d.command("start").description("\u5F00\u53D1").option("-p, --port [port]","\u7AEF\u53E3\u53F7","9000").action(e=>{v("index","/",!0,e.port)});d.command("build").description("\u6784\u5EFA").option("-p, --public-path [publicPath]","\u8BBE\u7F6EpublicPath, \u9ED8\u8BA4 /","/").action(e=>{v("index",e.publicPath,!1)});d.parse(process.argv);process.argv.length<3&&d.outputHelp();
